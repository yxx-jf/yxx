import{_ as e,c as o,o as i,a as c}from"./app.0bad1f24.js";const l="/yxx/mydocs/cookie和session.png",d="/yxx/mydocs/cookie-domain.png",t="/yxx/mydocs/sso.png",g=JSON.parse('{"title":"HTTP请求中token和cookie有什么区别","description":"","frontmatter":{},"headers":[{"level":2,"title":"cookie","slug":"cookie","link":"#cookie","children":[]},{"level":2,"title":"cookie本地存储","slug":"cookie本地存储","link":"#cookie本地存储","children":[]},{"level":2,"title":"cookie 跨域限制","slug":"cookie-跨域限制","link":"#cookie-跨域限制","children":[]},{"level":2,"title":"浏览器禁用第三方 cookie","slug":"浏览器禁用第三方-cookie","link":"#浏览器禁用第三方-cookie","children":[]},{"level":2,"title":"cookie 和 session","slug":"cookie-和-session","link":"#cookie-和-session","children":[]},{"level":2,"title":"token","slug":"token","link":"#token","children":[]},{"level":2,"title":"token 和 JWT","slug":"token-和-jwt","link":"#token-和-jwt","children":[]},{"level":2,"title":"session 和 JWT 比较，你更推荐哪个？","slug":"session-和-jwt-比较-你更推荐哪个","link":"#session-和-jwt-比较-你更推荐哪个","children":[]},{"level":2,"title":"如何实现SSO单点登录","slug":"如何实现sso单点登录","link":"#如何实现sso单点登录","children":[{"level":3,"title":"SSO","slug":"sso","link":"#sso","children":[]},{"level":3,"title":"OAuth2","slug":"oauth2","link":"#oauth2","children":[]}]}],"relativePath":"interview/知识广度-从前端到全栈/03-HTTP请求中token和cookie有什么区别.md"}'),s={name:"interview/知识广度-从前端到全栈/03-HTTP请求中token和cookie有什么区别.md"},a=c('<h1 id="http请求中token和cookie有什么区别" tabindex="-1">HTTP请求中token和cookie有什么区别 <a class="header-anchor" href="#http请求中token和cookie有什么区别" aria-hidden="true">#</a></h1><ul><li>cookie：http 规范；有跨域限制；可存储在本地；可配合 session 实现登录</li><li>token：自定义标准；不在本地存储；无跨域限制；可用于 JWT 登录</li></ul><h2 id="cookie" tabindex="-1">cookie <a class="header-anchor" href="#cookie" aria-hidden="true">#</a></h2><ul><li><code>HTTP</code> 无状态，每次请求都要带 <code>cookie</code>，以帮助识别身份</li><li>服务端也可以向客户端 <code>set-cookie</code>，<code>cookie</code> 大小限制 <code>4kb</code></li><li>默认有跨域限制:不可跨域共享、传递 <code>cookie</code></li></ul><h2 id="cookie本地存储" tabindex="-1">cookie本地存储 <a class="header-anchor" href="#cookie本地存储" aria-hidden="true">#</a></h2><ul><li><code>HTML5</code>之前 <code>cookie</code> 常被用于本地存储</li><li><code>HTML5</code> 之后推荐使用<code>localStorage</code> 和 <code>sessionStorage</code></li></ul><h2 id="cookie-跨域限制" tabindex="-1">cookie 跨域限制 <a class="header-anchor" href="#cookie-跨域限制" aria-hidden="true">#</a></h2><p>浏览器存储 cookie 是按照域名区分的，在浏览器无法通过 JS <code>document.cookie</code> 获取到其他域名的 cookie 。</p><p>http 请求传递 cookie 默认有跨域限制。如果想要开启，需要客户端和服务器同时设置允许</p><ul><li>客户端：使用 fetch 和 XMLHttpRequest 或者 axios 需要配置 <code>withCredentials</code></li><li>服务端：需要配置 header <code>Access-Control-Allow-Credentials</code></li></ul><h2 id="浏览器禁用第三方-cookie" tabindex="-1">浏览器禁用第三方 cookie <a class="header-anchor" href="#浏览器禁用第三方-cookie" aria-hidden="true">#</a></h2><ul><li>现代浏览器都开始禁用第三方 <code>cookie</code> （第三方 js 设置 <code>cookie</code>）</li><li>目的是打击第三方广告，保护用户个人隐私。</li><li>新增属性 <code>SameSite: Strict(严格规则) / Lax(松散) /None(禁止);</code> 值可自己选择</li></ul><p>例如一个电商网站 A 引用了淘宝广告的 js</p><ul><li>你访问 A 时，淘宝 js 设置 <code>cookie</code> ，记录下商品信息</li><li>你再次访问淘宝时，淘宝即可获取这个 <code>cookie</code> 内容</li><li>再和你的个人信息（也在 <code>cookie</code> 里）一起发送到服务端，这样就知道了你看了哪个商品</li></ul><h2 id="cookie-和-session" tabindex="-1">cookie 和 session <a class="header-anchor" href="#cookie-和-session" aria-hidden="true">#</a></h2><ul><li><code>cookie</code> 用于登录验证，存储用户标识(如 <code>userId</code>)</li><li><code>session</code> 在服务端，存储用户详细信息，和 <code>cookie</code> 信息一一对应</li><li><code>cookie + session</code> 是常见登录验证解决方案</li></ul><p><code>cookie</code> 用途非常广泛，最常见的就是登录。</p><p>使用 <code>cookie</code> 做登录校验:</p><ul><li>前端输入用户名密码，传给后端</li><li>后端验证成功，返回信息时 <code>set-cookie</code></li><li>接下来所有接口访问，都自动带上 <code>cookie</code> （浏览器的默认行为， <code>http 协议</code>的规定） <img src="'+l+'" alt="" data-fancybox="gallery"></li></ul><p>什么是 <code>session</code> ？</p><ul><li><code>cookie</code> 只存储 <code>userId</code> ，不去暴露用户信息</li><li>用户信息存储在 <code>session</code> 中 —— <code>session</code> 就是服务端的一个 <code>hash</code> 表</li></ul><h2 id="token" tabindex="-1">token <a class="header-anchor" href="#token" aria-hidden="true">#</a></h2><p><code>token</code> 和 <code>cookie</code> 一样，也是一段用于客户端身份验证的字符串，随着 <code>http</code> 请求发送</p><ul><li><code>cookie</code> 是 <code>http</code> 协议规范的，而 token 是自定义的，可以用任何方式传输（如<code> header body query-string</code> 等）</li><li><code>cookie</code> 默认会被浏览器存储</li><li><code>token</code> 默认不会在浏览器存储</li><li><code>token</code> 没有跨域限制</li></ul><p>所以，<code>token</code> 很适合做跨域或者第三方的身份验证。</p><h2 id="token-和-jwt" tabindex="-1">token 和 JWT <a class="header-anchor" href="#token-和-jwt" aria-hidden="true">#</a></h2><p><code>JWT === JSON Web Token</code></p><p><code>JWT</code> 的过程</p><ul><li>前端输入用户名密码，传给后端</li><li>后端验证成功，返回一段 <code>token</code> 字符串 - 将用户信息加密之后得到的</li><li>前端获取 <code>token</code> 之后，存储下来</li><li>以后访问接口，都在 header 中带上这段 <code>token</code></li></ul><h2 id="session-和-jwt-比较-你更推荐哪个" tabindex="-1">session 和 JWT 比较，你更推荐哪个？ <a class="header-anchor" href="#session-和-jwt-比较-你更推荐哪个" aria-hidden="true">#</a></h2><p>Session 优点</p><ul><li>原理简单，易于学习</li><li>用户信息存储在服务端，可以快速封禁某个登录的用户 —— 有这方强需求的人，一定选择 Session</li></ul><p>Session 的缺点</p><ul><li>占用服务端内存，有硬件成本</li><li>多进程、多服务器时，不好同步 —— 一般使用第三方 redis 存储 ，成本高</li><li>跨域传递 cookie ，需要特殊配置</li></ul><p>JWT 的优点</p><ul><li>不占用服务器内存</li><li>多进程、多服务器，不受影响</li><li>不受跨域限制</li></ul><p>JWT 的缺点</p><ul><li>无法快速封禁登录的用户</li><li>万一服务端秘钥被泄漏，则用户信息全部丢失</li><li>token 体积一般大于 cookie，会增加请求的数据量</li></ul><p>总结：如果没有“快速封禁登录用户”的需求，建议使用 JWT 方式。</p><h2 id="如何实现sso单点登录" tabindex="-1">如何实现SSO单点登录 <a class="header-anchor" href="#如何实现sso单点登录" aria-hidden="true">#</a></h2><ul><li>主域名相同，则可共享<code>cookie</code></li><li>主域名不同，则需使用<code>SSO</code></li><li><code>cookie</code>默认不可跨域共享，但有些情况下可设置为共享</li><li>主域名相同，如：<code>www.baidu.com image.baidu.com</code></li><li>设置 <code>cookie domain</code>为主域名，即可共享<code>cookie</code></li><li>主域相同，子域不同，可以设置<code>document.domain</code>来解决跨域</li></ul><p><img src="'+d+'" alt="" data-fancybox="gallery"></p><h3 id="sso" tabindex="-1">SSO <a class="header-anchor" href="#sso" aria-hidden="true">#</a></h3><ul><li>主域名完全不同，则<code>cookie</code>无法共享</li><li>可使用<code>SSO</code>技术方案</li></ul><p><img src="'+t+'" alt="" data-fancybox="gallery"></p><h3 id="oauth2" tabindex="-1">OAuth2 <a class="header-anchor" href="#oauth2" aria-hidden="true">#</a></h3><p>上述 SSO 是 oauth 的实际案例，其他常见的还有微信登录、github 登录等。即，当设计到第三方用户登录校验时，都会使用 OAuth2.0 标准。</p>',47),n=[a];function k(r,h,u,p,_,T){return i(),o("div",null,n)}const m=e(s,[["render",k]]);export{g as __pageData,m as default};
